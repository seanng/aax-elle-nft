generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model EncryptedImage {
  id             String          @id @default(auto()) @map("_id") @db.ObjectId
  url            String          @unique
  secretMessages SecretMessage[] // if v2
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
}

model SecretMessage {
  id                String         @id @default(auto()) @map("_id") @db.ObjectId
  message           String
  senderEmail       String
  donationAmount    String // wei
  isPrivateOnly     Boolean        @default(true) // word cloud + update json on decrypt
  encryptedImage    EncryptedImage @relation(fields: [encryptedImageUrl], references: [url])
  encryptedImageUrl String         @db.ObjectId
  senderAddress     String?
  receiverAddress   String?
  nftId             String?
  contractAddress   String?
  tokenURI          String?
  mintedAt          DateTime?
  decryptedAt       DateTime?
  createdAt         DateTime       @default(now())
  updatedAt         DateTime       @updatedAt
}
